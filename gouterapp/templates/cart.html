<!-- {% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link rel="shortcut icon" href="{% static 'gouterapp/images/favicon.png' %}" type="">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <style>
        @media (min-width: 1025px) {
            .h-custom {
                height: 100vh !important;
            }
        }

        .card-registration .select-input.form-control[readonly]:not([disabled]) {
            font-size: 1rem;
            line-height: 2.15;
            padding-left: .75em;
            padding-right: .75em;
        }

        .card-registration .select-arrow {
            top: 13px;
        }
    </style>
</head>

<body>
    <section class="h-100 h-custom" style="background-color: #d2c9ff;">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12">
                    <div class="card card-registration" style="border-radius: 15px;">
                        <div class="card-body">
                            <h1 class="fw-bold mb-5">Shopping Cart</h1>
        
                            <div class="row mb-4">
                                {% for item_id, item in cart.items %}
                                <div class="col-md-3 col-lg-2">
                                    <img src="{{ item.image }}" class="img-fluid rounded-3" alt="{{ item.name }}">
                                </div>
                                <div class="col-md-3 col-lg-3">
                                    <h6 class="text-muted">{{ item.name }}</h6>
                                    <p>Quantity: {{ item.quantity }}</p>
                                    <p>Price: ${{ item.price }}</p>
                                </div>
                                {% endfor %}
                            </div>
        
                            <hr class="my-4">
        
        
                            <h3>Total: ${{ total_price }}</h3>
        
                            <a href="#" class="btn btn-primary">Proceed to Checkout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </section>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html> -->

{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link rel="shortcut icon" href="{% static 'gouterapp/images/favicon.png' %}" type="">
    <link rel="stylesheet" type="text/css" href="{% static 'gouterapp/css/bootstrap.css' %}">
    <!-- <link href="{% static 'gouterapp/css/font-awesome.min.css'%}" rel="stylesheet" /> -->
    <link href="{% static 'gouterapp/css/style.css'%}" rel="stylesheet" />
    <!-- responsive style -->
    <link href="{% static 'gouterapp/css/responsive.css'%}" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <style>
        @media (min-width: 1025px) {
            .h-custom {
                height: 100vh !important;
            }
        }

        .card-registration .select-input.form-control[readonly]:not([disabled]) {
            font-size: 1rem;
            line-height: 2.15;
            padding-left: .75em;
            padding-right: .75em;
        }

        .card-registration .select-arrow {
            top: 13px;
        }

        /* Add spacing between each cart item */
        .cart-item {
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <section class="h-100 h-custom" style="background-color: #d2c9ff;">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12">
                    <div class="card card-registration" style="border-radius: 15px;">
                        <div class="card-body">
                            <h1 class="fw-bold mb-5">Dish Cart</h1>

                            <!-- Cart Items -->
                            <div id="cart-items">
                                {% for item_id, item in cart.items %}
                                <div class="row cart-item d-flex align-items-center" data-price="{{ item.price }}">
                                    <div class="col-md-3 col-lg-2">
                                        <img src="{{ item.image }}" class="img-fluid rounded-3" alt="{{ item.name }}">
                                    </div>
                                    <div class="col-md-3 col-lg-3">
                                        <h6 class="text-muted">{{ item.name }}</h6>
                                        <p class="item-price">Price: Rs <span class="price">{{ item.price }}/-</span>
                                        </p>
                                    </div>
                                    <div class="col-md-3 col-lg-3 col-xl-2 d-flex">
                                        <form method="POST" action="{% url 'update_cart' item_id %}"
                                            class="update-cart-form">
                                            {% csrf_token %}
                                            <button class="btn btn-link px-2" type="submit" name="action"
                                                value="decrease">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input min="1" name="quantity" value="{{ item.quantity }}" type="number"
                                                class="form-control form-control-sm quantity-input"
                                                onchange="updateTotal()" />
                                            <button class="btn btn-link px-2" type="submit" name="action"
                                                value="increase">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </form>
                                    </div>
                                    <div class="col-md-3 col-lg-3 col-xl-2">
                                        <form method="POST" action="{% url 'remove_from_cart' item_id=item_id %}">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-danger">Remove</button>
                                        </form>
                                    </div>
                                </div>
                                <hr class="my-4"> <!-- Add a line to separate each cart item -->
                                {% endfor %}
                            </div>

                            <!-- Back Button -->
                            <!-- {% if seller_id %}
                            <a href="{% url 'view_dishes' seller_id=seller_id %}">Go back</a>
                            {% endif %} -->

                            <h3>Total: Rs <span id="total-price">{{ total_price }}/-</span></h3>

                            <a href="{% url 'choose_method' %}?seller_id={{ seller_id }}" class="btn btn-primary">Proceed to Checkout</a>
                            {% if cart %}

                            <!-- Back button to seller's dishes or back to the previous page -->
                            {% if seller_id %}
                            <a href="{% url 'view_dishes' seller_id=seller_id %}" class="btn btn-primary">Back to
                                Dishes</a>
                            {% else %}
                            <a href="javascript:history.back()" class="btn btn-primary">Go Back</a>
                            {% endif %}
                            {% else %}
                            <p>Your cart is empty.</p>
                            <a href="javascript:history.back()" class="btn btn-primary">Go Back</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>
        function updateTotal() {
            let total = 0;
            const items = document.querySelectorAll('.cart-item');

            items.forEach(item => {
                const price = parseFloat(item.dataset.price);
                const quantity = parseInt(item.querySelector('.quantity-input').value);
                total += price * quantity;
            });

            document.getElementById('total-price').textContent = total.toFixed(2);
        }
    </script>
</body>

</html>